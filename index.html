<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Informed Consent</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css">
    <link rel="stylesheet" href="style.css">
</head>

<body>



    <section class="hero has-background-warning	">
        <div class="box has-text-centered not-round">
            <<<<<<< HEAD <button class="button is-dark is-inline-block" id="langtrigger" data-eng="false"> Malayalam Version</button>
                =======
                <button class="button is-dark is-inline-block" id="langtrigger" data-eng="true"> Malayalam Version</button>
                >>>>>>> bulma
        </div>
        <div class="hero-body has-text-centered">
            <p class="title">
                Covidiots Covid 19 Facts Kerala
            </p>
            <p class="subtitle">
                Short bullet points to explain the scam going on to coersive people
            </p>

        </div>
    </section>


    <section class="section has-background-grey">
        <ul class="ul">

            <div class="columns">
                <div class="column  ul-container"></div>
            </div>

        </ul>
    </section>

    <div class="modal is-active ">
        <div class="modal-background is-dark">
        </div>
        <div class="modal-content">
            <!-- 
            <div class="container has-background-danger centered">
                <h2 class="subtitle">Disclaimer</h2>
                <h1 class="title">Content provided from this page may not be 100 % accurate</h1>
            </div> -->


            <div class="hero m-2">
                <div class="hero-body has-background-warning is-flex is-justify-content-center is-align-items-center">
                    <div class="wrapper has-text-centered">
                        <h1 class="disclaim-heading is-size-4 has-text-weight-bold">Covid vaccine Informed consent</h1>
                        <hr class="has-text-centered is-inline-block pt-1" width="50%">
                        <h1 class="title is-4 disclaim-title">Disclaimer</h1>
                        <h1 class="px-4 py-1 subtitle is-size-6 has-text-weight-medium disclaim-content">contents and opinions provided in this page might not be 100% accurate , any decision you make on the basis of anything you read here will be completely yours and <span class="is-underlined has-text-weight-bold is-size-5">we hold no responsiblity whatsoever</span>

                        </h1>

                        <a href="https://google.co.in" class="disclaim-btn disclaim-no button is-size-6 is-size-7-mobile mb-1 is-danger is-inline-block">I disagree , redirect me to google</a>
                        <button class="disclaim-btn disclaim-yes button is-success is-size-6 is-size-7-mobile is-inline-block agree">I agree completely, continue to page</button>


                    </div>

                </div>
            </div>



        </div>
    </div>


    <script>
        // fetch('https://raw.githubusercontent.com/AmarjithTK/storage__bin/master/coaid.json').then(data => data.json()).
        // then(json => updateData(json))


        const malurl = 'https://raw.githubusercontent.com/AmarjithTK/storage__bin/master/cdn/malcoaid.json'
        const engurl = 'https://raw.githubusercontent.com/AmarjithTK/storage__bin/master/cdn/engcoaid.json'


        const langtrigger = document.getElementById('langtrigger')
        const title = document.querySelector('.title')
        const subtitle = document.querySelector('.subtitle')
        const ulcontainer = document.querySelector('.ul-container')

        const agreebtn = document.querySelector('.agree')
        const modal = document.querySelector('.modal')

        const disheading = document.querySelector('.disclaim-heading')
        const distitle = document.querySelector('.disclaim-title')
        const discontent = document.querySelector('.disclaim-content')
        const disyes = document.querySelector('.disclaim-yes')
        const disno = document.querySelector('.disclaim-no')







        const fetchdata = async (url, firstfetch) => {
            try {
                console.log(url);
                const data = await fetch(url)
                const jsondata = await data.json()
                console.log(jsondata);
                if (firstfetch) {
                    updatePopup(jsondata)
                }
                updatebody(jsondata)
            } catch (error) {
                console.log(error);
                // location.reload()
            }
        }

        const updatePopup = (data) => {

            disheading.innerHTML = data['title']
            distitle.innerHTML = data['disclaimerTitle']
            discontent.innerHTML = data['disclaimer']
            disyes.innerHTML = data['buttonYes']
            disno.innerHTML = data['buttonNo']

        }


        const updatebody = (data) => {

            const dbuttontext = data['buttonText']
            const dtitle = data['title']
            const dsubtitle = data['subtitle']
            const dbullet = data['bulletpoints']




            langtrigger.innerHTML = dbuttontext
            title.innerHTML = dtitle
            subtitle.innerHTML = dsubtitle

            ulcontainer.innerHTML = ''
            dbullet.forEach(element => {

                try {
                    if (element["sources"].length > 0) {

                        template = `<div class="box mb-2 has-text-centered">${element['text']}  `

                        element["sources"].forEach(elem => {
                            template += `<a href="${elem}">Ref</a>,`
                        })
                        template += '</div>'

                        ulcontainer.innerHTML += template

                    }
                } catch (error) {
                    ulcontainer.innerHTML += ` <div class="box mb-2 has-text-centered">${element}</div>`

                }


            });
            langtrigger.classList.remove('is-loading') // remove the loading once fetch finished

        }


        const triggerHandler = (e) => {
            console.log('here i am');
            langtrigger.classList.add('is-loading')

            // e.preventDefault()
            if (langtrigger.getAttribute('data-eng') == 'true') {
                langtrigger.classList.remove('is-link')
                fetchdata(malurl, false)
                localStorage.setItem('lang', 'mal')

                langtrigger.setAttribute('data-eng', 'false')
            } else if (langtrigger.getAttribute('data-eng') == 'false') {
                langtrigger.classList.add('is-link')
                fetchdata(engurl, false)
                langtrigger.setAttribute('data-eng', 'true')
                localStorage.setItem('lang', 'eng')

            }


        }

        const defaultUrl = localStorage.getItem('lang') == 'eng' ? engurl : malurl

        fetchdata(defaultUrl, true) // starting in english


        langtrigger.addEventListener('click', triggerHandler)

        agreebtn.addEventListener('click', (e) => {
            modal.classList.remove('is-active')
        })
        //   const ul = document.querySelector('.ul');
    </script>
</body>

</html>